---
layout: post
title: C#编码规范
subtitle:   
date:   2019-07-01
author: JP
header-img: img/post-bg-ioses.jpg
catalog: true
tags:
- C#
---

> C#编码规范

### 第一章 概述

#### 1.1 术语定义

##### 1.1.1 Pascal 大小写
将标识符的首字母和后面连接的每个单词的首字母都大写。可以对三字符或更多字符的标识符使用Pascal 大小写。例如： BackColor

##### 1.1.2 Camel 大小写
标识符的首字母小写，而每个后面连接的单词的首字母都大写。例如：backColor

##### 1.1.3 _Camel 引用大小写
标识符的首字母小写，而每个后面连接的单词的首字母都大写。例如：_backColor

### 第二章 概述

2.1  列宽
    代码列宽控制在210字符左右。(建议使用1280*1024分辨率显示屏)。
2.2  换行
      当表达式超出或即将超出规定的列宽，遵循以下规则进行换行
          1、在逗号后换行;
          2、在操作符前换行;
          3、规则1优先于规则2。             
2.3  缩进
     缩进应该是每行一个Tab(4个空格)，不要在代码中使用Tab字符。
2.4  空行
空行是为了将逻辑上相关联的代码分块，以便提高代码的可阅读性。
  在代码中，不能包含多个空行。       
     
    在以下情况下使用一个空行
         1、方法与方法、属性与属性之间。
         2、方法中变量声明与语句之间。
         3、方法与方法之间。
         4、方法中不同的逻辑块之间。
      　 5、方法中的返回语句与其他的语句之间。
         6、属性与方法、属性与字段、方法与字段之间。
         7、注释与它注释的语句间不空行，但与其他的语句间空一行。
2.5  空格
在以下情况中要使用到空格
        1、 关键字和左括符 “(” 应该用空格隔开。如while (true)    
           注意:在方法名和左括符 “(” 之间不要使用空格，这样有助于辨认代码中的方法调用与关键字。
          
2、   多个参数用逗号隔开，每个逗号后都应加一个空格。
3、   除了 . 之外，所有的二元操作符都应用空格与它们的操作数隔开。一元操作符、++及--与操作数间不需要空格。如
                a  +=  c  +  d;
             a  =  (a  +  b)   /   (c  *  d);
                while  (d++  =  s++)
                {
                    n++;
                }
                PrintSize(“size is “  +  size  +  “\n”);
4、 语句中的表达式之间用空格隔开。如
       for  (expr1;  expr2;  expr3)
2.6  括号 - ()
      1、 左括号“(” 不要紧靠关键字，中间用一个空格隔开。
      2、 左括号“(”  与方法名之间不要添加任何空格。
      3、 没有必要的话不要在返回语句中使用()。如
  
        if (condition)
            Array.Remove(1)
            return 1 
2.7  花括号 - {}
       1、左花括号 “{” 放于关键字或方法名的下一行并与之对齐。如
             if (condition)
             {
             }
             public int Add(int x, int y)
             {
             }
                           2、 左花括号 “{” 要与相应的右花括号 “}”对齐。
       3、通常情况下左花括号 “{”单独成行，不与任何语句并列一行。
       4、 if、while、do语句后一定要使用{}，即使{}号中为空或只有一条语句。如
             if (somevalue == 1)
             {
                 somevalue = 2;
             }
5、 右花括号 “}” 后建议加一个注释以便于方便的找到与之相应的 {。如
               while  (1)
               {
                   if  (valid)
                   {
                   }
                   else
                   {
                   } // if
                } // while


### 第三章 概述

3.1  注释概述
1、修改代码时，总是使代码周围的注释保持最新。
2、在每个例程的开始，提供标准的注释样本以指示例程的用途、假设和限制很有帮助。注释样本应该是解释它为什么存在和可以做什么的简短介绍.
3、避免在代码行的末尾添加注释；行尾注释使代码更难阅读。不过在批注变量声明时，行尾注释是合适的；在这种情况下，将所有行尾注释在公共制表位处对齐。
4 、避免杂乱的注释，如一整行星号。而是应该使用空白将注释同代码分开。
5 、避免在块注释的周围加上印刷框。这样看起来可能很漂亮，但是难于维护。
6 、在部署发布之前，移除所有临时或无关的注释，以避免在日后的维护工作中产生混乱。
7 、如果需要用注释来解释复杂的代码节，请检查此代码以确定是否应该重写它。尽一切可能不注释难以理解的代码，而应该重写它。尽管一般不应该为了使代码更简单以便于人们使用而牺牲性能，但必须保持性能和可维护性之间的平衡。
8 、在编写注释时使用完整的句子。注释应该阐明代码，而不应该增加多义性。
9 、在编写代码时就注释，因为以后很可能没有时间这样做。另外，如果有机会复查已编写的代码，在今天看来很明显的东西，六周以后或许就不明显了。
10 、避免多余的或不适当的注释，如幽默的不主要的备注。
11、 使用注释来解释代码的意图。它们不应作为代码的联机翻译。
12、 注释代码中不十分明显的任何内容。
13 、为了防止问题反复出现，对错误修复和解决方法代码总是使用注释，尤其是在团队环境中。
14 、对由循环和逻辑分支组成的代码使用注释。这些是帮助源代码读者的主要方面。
15 、在整个应用程序中，使用具有一致的标点和结构的统一样式来构造注释。
16 、用空白将注释同注释分隔符分开。在没有颜色提示的情况下查看注释时，这样做会使注释很明显且容易被找到。
17 、在所有的代码修改处加上修改标识的注释。
18 、为了是层次清晰，在闭合的右花括号后注释该闭合所对应的起点。
    namespace Langchao.Procument.Web
{
} // namespace Langchao.Procument.Web
3.2          文件注释
在每个文件头必须包含以下注释说明
// <copyright file="文件名.cs" company="HP">
//  Copyright (c) HP. All rights reserved.
// </copyright>
// <author>×××</author>
// <date> yyyy-mm-dd </date>
// <summary>文件功能描述</summary>
// <modify>
//      修改人：×××
//      修改时间：yyyy-mm-dd
//      修改描述：×××
//      版本：1.0
//</modify>
注意：文件功能描述只需简述，具体详情在类的注释中描述。创建标识和修改标识由创建或修改人员的拼音或英文名。如：Zhangsan。一天内有多个修改的只需做一个在注释说明中做一个修改标识就够了。在所有的代码修改处加上修改标识的注释。

为了方便起见，可以使用Visual Studio 自动生成注释的功能，找到VS安装目录的Class.cs文件，具体路径：
#vs2019
C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\Common7\IDE\ItemTemplates\CSharp\Code\2052\Class
#vs2017
C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\ItemTemplates\CSharp\Code\2052\Class

打开文件，在顶部添加注释
#region << 版 本 注 释 >>
/*----------------------------------------------------------------
* 项目名称 ：$rootnamespace$
* 项目描述 ：
* 类 名 称 ：$safeitemname$
* 类 描 述 ：
* 所在的域 ：$userdomain$
* 命名空间 ：$rootnamespace$
* 机器名称 ：$machinename$ 
* CLR 版本 ：$clrversion$
* 作    者 ：$username$
* 创建时间 ：$time$
* 修    改 ：
*           修改人：$username$
*           修改时间：$time$
*           修改描述：
*           版本：v1.0.0.0
* 版 本 号 ：v1.0.0.0
*******************************************************************
* Copyright @ $username$ $year$. All rights reserved.
*******************************************************************
//----------------------------------------------------------------*/
#endregion
using System;
using System.Collections.Generic;
$if$ ($targetframeworkversion$ >= 3.5)using System.Linq;
$endif$using System.Text;
$if$ ($targetframeworkversion$ >= 4.5)using System.Threading.Tasks;
$endif$
namespace $rootnamespace$
{
    class $safeitemrootname$
    {
    }
}


3.3          文档型注释
 该类注释采用.Net已定义好的Xml标签来标记，在声明接口、类、方法、属性、字段都应该使用该类注释，以便代码完成后直接生成代码文档，让别人更好的了解代码的实现和接口。如
3.3.1、   类、接口注释
/// <summary>
    /// 类功能的说明
    /// </summary>
    /// <see cref=""></see>
    /// <remarks>
    /// 创建人：Zhangsan
    /// 创建日期：yyyy-mm-dd
    /// 修改人：Lisi
    /// 修改日期：yyyy-mm-dd
    /// 修改备注：无
    /// 版本：1.0
    /// </remarks>
    public class CountersModuleInitializer : ModuleInitializer
    {
}
注意：<see cref=""></see>标签根据具体情况选择有无
3.3.2、   方法、事件注释
/// <summary>
        /// 根据员工编号获得员工信息
        /// </summary>
        /// <param name="employeeId">员工编号</param>
        /// <exception cref="System.Exception">系统异常</exception>
        /// <returns>员工姓名</returns>
        /// <remarks>
        /// 创建人：Zhangsan
        /// 创建日期：yyyy-mm-dd
        /// 修改人：Lisi
        /// 修改日期：yyyy-mm-dd
        /// 修改备注：无
        /// 版本：1.1
        /// </remarks>
        public string GetEmployeeNameById(int employeeId)
        {
            try
            {
                return "ddd";
            }
            catch (System.Exception)
            {
                throw;
            }
}
注意：该方法注释中的<param></param>、<exception cref=" "></exception>、<returns></returns>等标签根据具体情况选择有无，方法初始版本为1.0，每次改动增加0.1。
3.3.3、   属性、常量注释
/// <summary>
        /// session id
        /// </summary>
public const string SESSION_ID = "";
3.3.4、  单行注释
      该类注释用于
1 方法内的代码注释。如变量的声明、代码或代码段的解释。注释示例：
         // 注释语句
         private int number;
    
          2 方法内变量的声明或花括号后的注释, 注释示例：
if ( 1 == 1)    // always true
                {
                  statement;
                   }
                   else     // always false
                   {
}
3.4 JavaScript注释
  a) 注释符号
        ‘//’
        不允许使用‘/**/’作注释符。
    b) 函数注释
每个函数都应该描述该函数的名称、功能、作用范围、入口参数的类型和传值方式及参数含义、返回值类型及返回值的含义。格式如下：
//
//Function:  函数名
//Purpose:   用途
//Scope:     作用范围
//Args:      入口参数(列表)     类型传值方式含义
//Returns:   返回值类型  (可确定值列表)  含义
//
c) 非函数注释
   注明该模块的作用
   格式如下：
//
//功能：
//
d) 程序行间注释
   在程序行的每一个处理单元前作注释
   格式如下：
   //注释
e) 注释举例
     //
//Function:  F_FindObject
//Purpose:   按照空间名在可视化主对象中查找住对象内的可视化控件
//Scope:     Public
//Args:      is_name        String   value：要查找的空间名
//           ipbo_object    Object   value: 可视化主对象
//Returns:   Boolean        True     表示找到该控件
//                          False    表示没有找到该控件
//
function F_FindObject(is_name, ipbo_object) {
 
    //获得显示学生信息的GreeView控件
    var gv_student = document.getElementById("GVStudent");
   
    ***********
   
    //返回true
    return true;
}


### 第四章 概述

### 第五章 命名规范 ⭐ ⭐

#### 5.1 命名概述
名称应该说明“什么”而不是“如何”。通过避免使用公开基础实现（它们会发生改变）的名称，可以保留简化复杂性的抽象层。例如，可以使用 GetNextStudent()，而不是 GetNextArrayElement()。

命名原则是：

选择正确名称时的困难可能表明需要进一步分析或定义项的目的。使名称足够长以便有一定的意义，并且足够短以避免冗长。唯一名称在编程上仅用于将各项区分开。表现力强的名称是为了帮助人们阅读；因此，提供人们可以理解的名称是有意义的。不过，请确保选择的名称符合适用语言的规则和标准。

以下几点是推荐的命名方法。

1. 避免容易被主观解释的难懂的名称，如方法名 AnalyzeThis()，或者属性名 xxK8。这样的名称会导致多义性。
2. 在类属性的名称中包含类名是多余的，如 Book.BookTitle。而是应该使用 Book.Title。
3. 只要合适，在变量名的末尾或开头加计算限定符（Avg、Sum、Min、Max、Index）。
4. 在变量名中使用互补对，如 min/max、begin/end 和 open/close。
5. 布尔变量名应该包含 Is，这意味着 Yes/No 或 True/False 值，如 fileIsFound。
6. 在命名状态变量时，避免使用诸如 Flag 的术语。状态变量不同于布尔变量的地方是它可以具有两个以上的可能值。不是使用 documentFlag，而是使用更具描述性的名称，如 documentFormatType。 （此项只供参考）
7. 即使对于可能仅出现在几个代码行中的生存期很短的变量，仍然使用有意义的名称。仅对于短循环索引使用单字母变量名，如 i 或 j。 可能的情况下，尽量不要使用原义数字或原义字符串，如
For i = 1 To 7。而是使用命名常数，如 For i = 1 To NUM_DAYS_IN_WEEK 以便于维护和理解。
8. 用于事件处理的委托添加 **EventHandler** 后缀
9. 用于事件处理之外的那些委托添加 **Callback** 后缀
10. 不要给委托添加 **Delegate** 后缀
11. 用名词或名词词组来给类型命名，在少数情况下也可以用形容词词组来给类型命名
12. 用动词或动词词组来命名方法
13. 用名词、名词词组或形容词来命名属性
14. 要用动词或动词短语来命名事件
15. 要用名词或名词短语来命名字段

#### 5.2 大小写规则

大写

标识符中的所有字母都大写。仅对于由两个或者更少字母组成的标识符使用该约定。例如：

**System.IO**

**System.Web.UI**

下表汇总了大写规则，并提供了不同类型的标识符的示例。

标识符 | 	大小写 |	样例
:---:|:---:|:---:
类 | Pascal |	public class StreamReader { … }
接口 | Pascal |	public interface IEnumerable { … }
属性 | Pascal |	public string Name { get; set; }
方法 | Pascal |	public class Object { public virtual string ToString(); }
事件 | Pascal |	public class Process { public event EventHandler Exited; }
字段(私有实例) | Camel | private string userName；
字段(公共静态) | Pascal | public static readonly string UserId;
常量 (const) | 全部大写 |	public const string PAGE_TITLE = "Welcome";
枚举 | Pascal |	enum FileMode { Append, … }
参数 | Camel |	public class Convert { public static int ToInt32(string userId); }
命名空间 | Pascal |	namespace System.Security { … }

### 第六章 语句 ⭐ 

### 第七章 控件命名规则（参考）

#### 7.1控件命名规则（参考）
控件名简写+英文描述，英文描述首字母大写

控件名 | 简写
:---:|:---:
AdRotator | ar
Button | btn
Calender | cld
CheckBox | chk
CheckBoxList | chkls
CompareValidator | cv
CrystalReportViewer | rptvew
DropDownList | ddl
DataGrid | dg
DataList | dl
Label | lbl
LinkButton | lnkbtn
ListBox | lst
Panel | pnl
RadioButton | rdo
RangeValidator | rv
RadioButtonList | rdolt
RequiredFieldValidator | rfv
RegularExpressionValidator | rev
Image | img
ImageButton | imgbtn
ValidatorSummary | vs
TextBox | txt
Table | tbl

### 第八章 代码格式检查（可以先看看）

### 第九章 代码分析

使用Visual Studio自身的代码分析功能，检查内容如下表，分为

1. 安全规则。
2. 互操作性规则
3. 可维护性规则
4. 可以只性规则
5. 命名规则
6. 全球化规则
7. 设计规则
8. 性能规则
9. 移动性规则
10. 用法规则

其中“是否检查”一项中为“√”的内容不能违反。需在Visual Studio中设置为错误

#### 9.1.安全性规则

标识 | 详细信息 | 是否检查
:---:|:---:|:---:
CA2100 | 检查Sql查询中是否有安全漏洞 | √
CA2104 | 检查Sql查询中是否有安全漏洞 | √
CA2105 | 数组字段不应为只读 | √
CA2121 | 静态构造函数应为私有 | √

#### 9.2.可靠性规则

标识 | 详细信息 | 是否检查
:---:|:---:|:---:
CA2000 | 超出范围前释放对象 | √

#### 9.3.可维护性规则

标识 | 详细信息 | 是否检查
:---:|:---:|:---:
CA1500 | 变量名不应与字段名相同 | √
CA1501 | 避免过度继承 | √
CA1502 | 避免过度复杂 | √

#### 9.4.命名规则

标识 | 	详细信息 |	是否检查
:---:|:---:|:---:
CA1700 | 不要将枚举值命名为“Reserved” |	√
CA1705 | 较长的首字母缩略词应采用Pascal大小写格式。|	√
CA1706 | 较短的首字母缩略词应全部大写 |	√
CA1707 | 标识符不应包含下划线	| √
CA1709 | 标识符的大小写应该正确	| 	√
CA1710 | 标识符应具有正确的后缀	| 	√
CA1711 | 标识符应采用正确的后缀		| √
CA1712 | 不要将类型名用作枚举值的前缀	| 	√
CA1713 | 事件不应具有 before 或 after 前缀	| 	√
CA1715 | 标识符应具有正确的前缀	| 	√
CA1716 | 标识符不应与关键字冲突	| 	√
CA1718 | 避免在参数中使用特定于语言的类型名		| √
CA1719 | 参数名不应与成员名冲突		| √
CA1720 | 标识符不应包含类型名	| 	√
CA1721 | 属性名不应与 get 方法冲突		| √
CA1722 | 标识符应采用正确的前缀	| 	√
CA1724 |	类型名不应与命名空间冲突		| √
CA1725 | 参数名应与基方法中的声明保持一致	| 	√

#### 9.5.性能规则
标识 | 	详细信息 |	是否检查
:---:|:---:|:---:
CA1800 | 避免进行不必要的强制转换	| 	√
CA1804 | 移除未使用的局部变量		| √
CA1805 | 避免进行不必要的初始化	| 	√
CA1809 | 避免过多的局部变量		| √
CA1812 | 避免未实例化的内部类	| 	√
CA1813 | 避免未密封的属性		| √
CA1819 | 属性不应返回数组	| 	√
CA1823 | 避免未使用的私有字段	| 	√

#### 9.6.用法规则
标识 | 	详细信息 |	是否检查
:---:|:---:|:---:
CA1801 | 检查未使用的参数	| 	√
CA2202 | 不要多次释放对象	| 	√
CA2211 | 非常数字段不应该是可见的	| 	√
CA2218 | 重写 Equals 时重写 GetHashCode	| 	√
CA2219 | 不要在异常子句中引发异常		| √
CA2222 | 不要降低继承成员的可见性		| √
CA2230 | 对个数可变的参数使用 params		| √
CA2233 | 运算不应溢出	| 	√


##### 参考文档：<br/>

1. [C#编码规范](https://gist.github.com/zhuqling/a2700703d088b8746f0c)
2. [StyleCop](https://github.com/StyleCop/StyleCop)
